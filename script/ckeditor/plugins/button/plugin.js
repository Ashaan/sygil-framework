/*
Copyright (c) 2003-2009, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

CKEDITOR.plugins.add('button',{beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler);}});CKEDITOR.UI_BUTTON=1;CKEDITOR.ui.button=function(a){this.label=a.label;this.title=a.title||a.label;this.command=a.command;this.className=a.className||a.command&&'cke_button_'+a.command||'';this.click=a.click||(function(b){b.execCommand(a.command);});this._={};};CKEDITOR.ui.button.handler={create:function(a){return new CKEDITOR.ui.button(a);}};CKEDITOR.ui.button.prototype={render:function(a,b){var c=CKEDITOR.env,d=this._.id='cke_'+CKEDITOR.tools.getNextNumber(),e={id:d,button:this,editor:a,focus:function(){var h=CKEDITOR.document.getById(d);h.focus();},execute:function(){this.button.click(a);}},f=this.command;if(f){f=a.getCommand(f);if(f)f.on('state',function(){this.setState(f.state);},this);}var g=CKEDITOR.ui.button._.instances.push(e)-1;b.push('<a id="',d,'" class="cke_button ',this.className,'" href="javascript:void(\'',(this.label||'').replace("'",''),'\')" title="',this.title,'" tabindex="-1" hidefocus="true"');if(c.opera||c.gecko&&c.mac)b.push(' onkeypress="return false;"');if(c.gecko)b.push(' onblur="this.style.cssText = this.style.cssText;"');b.push(' onkeydown="return CKEDITOR.ui.button._.keydown(',g,', event);" onclick="return CKEDITOR.ui.button._.click(',g,', event);"><span class="cke_icon"></span><span class="cke_label">',this.label,'</span></a>');return e;},setState:function(a){var b=CKEDITOR.document.getById(this._.id);switch(a){case CKEDITOR.TRISTATE_ON:b.addClass('cke_on');b.removeClass('cke_off');b.removeClass('cke_disabled');break;case CKEDITOR.TRISTATE_DISABLED:b.addClass('cke_disabled');b.removeClass('cke_off');b.removeClass('cke_on');break;default:b.addClass('cke_off');b.removeClass('cke_on');b.removeClass('cke_disabled');break;}}};CKEDITOR.ui.button._={instances:[],click:function(a){CKEDITOR.ui.button._.instances[a].execute();return false;},keydown:function(a,b){var c=CKEDITOR.ui.button._.instances[a];if(c.onkey){b=new CKEDITOR.dom.event(b);return c.onkey(c,b.getKeystroke())!==false;}}};CKEDITOR.ui.prototype.addButton=function(a,b){this.add(a,CKEDITOR.UI_BUTTON,b);};
