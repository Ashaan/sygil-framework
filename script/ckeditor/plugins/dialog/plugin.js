/*
Copyright (c) 2003-2009, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

CKEDITOR.plugins.add('dialog',{requires:['dialogui']});CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){CKEDITOR.dialog=function(s,t){var u=CKEDITOR.dialog._.dialogDefinitions[t];if(!u){console.log('Error: The dialog "'+t+'" is not defined.');return;}u=CKEDITOR.tools.extend(u(s),a);u=new e(this,u);this.definition=u=CKEDITOR.fire('dialogDefinition',{name:t,definition:u},s).definition;var v=s.theme.buildDialog(s);this._={editor:s,element:v.element,name:t,size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},pageCount:0,lastTab:null};this.parts={tl:[0,0],tl_resize:[0,0,0],t:[0,1],t_resize:[0,1,0],tr:[0,2],tr_resize:[0,2,0],l:[1,0],l_resize:[1,0,0],c:[1,1],r:[1,2],r_resize:[1,2,0],bl:[2,0],bl_resize:[2,0,0],b:[2,1],b_resize:[2,1,0],br:[2,2],br_resize:[2,2,0],title:[1,1,0],close:[1,1,0,0],tabs:[1,1,1,0,0],tabs_table:[1,1,1],contents:[1,1,2],footer:[1,1,3]};var w=this._.element.getFirst();for(var x in this.parts)this.parts[x]=w.getChild(this.parts[x]);CKEDITOR.event.call(this);if(u.onLoad)this.on('load',u.onLoad);if(u.onShow)this.on('show',u.onShow);if(u.onHide)this.on('hide',u.onHide);if(u.onOk)this.on('ok',function(E){if(u.onOk.call(this,E)===false)E.data.hide=false;});if(u.onCancel)this.on('cancel',function(E){if(u.onCancel.call(this,E)===false)E.data.hide=false;});var y=this,z=function(E){var F=y._.contents,G=false;for(var H in F)for(var I in F[H]){G=E.call(this,F[H][I]);if(G)return;}};this.on('ok',function(E){z(function(F){if(F.validate){var G=F.validate(this);if(typeof G=='string'){alert(G);G=false;}if(G===false){if(F.select)F.select();else F.focus();E.data.hide=false;E.stop();return true;}}});},this,null,0);this.on('cancel',function(E){z(function(F){if(F.isChanged()){if(!confirm(s.lang.common.confirmCancel))E.data.hide=false;return true;}});},this,null,0);this.parts.close.on('click',function(E){if(this.fire('cancel',{hide:true}).hide!==false)this.hide();},this);if(CKEDITOR.env.ie6Compat)this.on('load',function(E){var F=this.getElement(),G=F.getFirst();G.remove();G.appendTo(F);},this);g(this);h(this);new CKEDITOR.dom.text(u.title,CKEDITOR.document).appendTo(this.parts.title);for(x=0;x<u.contents.length;x++)this.addPage(u.contents[x]);var A=/cke_dialog_tab(\s|$|_)/,B=/cke_dialog_tab(\s|$)/;this.parts.tabs.on('click',function(E){var F=E.data.getTarget(),G=F,H,I;if(!A.test(F.$.className))return;while(F.getName()!='td'||!B.test(F.$.className))F=F.getParent();H=F.$.id.substr(0,F.$.id.lastIndexOf('_'));
this.selectPage(H);},this);var C=[],D=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:'hbox',className:'cke_dialog_footer_buttons',widths:[],children:u.buttons},C).getChild();this.parts.footer.setHtml(C.join(''));for(x=0;x<D.length;x++)this._.buttons[D[x].id]=D[x];this._.dummyText=CKEDITOR.dom.element.createFromHtml('<input type="text" style="position: absolute; left: -100000px; top: -100000px" />');this._.dummyText.appendTo(w);CKEDITOR.skins.load(s.config.skin,'dialog');};CKEDITOR.dialog.prototype={resize:(function(){return function(s,t){var u=this;if(u._.size&&u._.size.width==s&&u._.size.height==t)return;CKEDITOR.dialog.fire('resize',{dialog:u,skin:u._.editor.config.skin,width:s,height:t},u._.editor);u._.size={width:s,height:t};};})(),getSize:function(){return CKEDITOR.tools.extend({},this._.size);},move:(function(){var s;return function(t,u){var w=this;if(s===undefined)s=w._.element.getFirst().getComputedStyle('position')=='fixed';if(s&&w._.position&&w._.position.x==t&&w._.position.y==u)return;w._.position={x:t,y:u};if(!s){var v=CKEDITOR.document.getWindow().getScrollPosition();t+=v.x;u+=v.y;}w._.element.getFirst().setStyles({left:t+'px',top:u+'px'});};})(),getPosition:function(){return CKEDITOR.tools.extend({},this._.position);},show:function(){var s=this._.element,t=this.definition;if(!(s.getParent()&&s.getParent().equals(CKEDITOR.document.getBody())))s.appendTo(CKEDITOR.document.getBody());else return;this.resize(t.minWidth,t.minHeight);var u=CKEDITOR.document.getWindow().getViewPaneSize();this.move((u.width-this._.size.width)/(2),(u.height-this._.size.height)/(2));this.selectPage(this.definition.contents[0].id);this.reset();if(CKEDITOR.dialog._.currentZIndex===null)CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex;this._.element.getFirst().setStyle('z-index',CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;j(this._.editor);CKEDITOR.document.on('keydown',m);CKEDITOR.document.on('keyup',n);}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;var v=this._.parentDialog.getElement().getFirst();v.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this;}o(this,this,'',null,function(){this.getButton('cancel')&&this.getButton('cancel').click();});if(!this._.parentDialog)this.saveSelection();this._.dummyText.focus();this._.dummyText.$.select();this.fireOnce('load',{});this.fire('show',{});},foreach:function(s){var v=this;
for(var t in v._.contents)for(var u in v._.contents[t])s(v._.contents[t][u]);return v;},reset:(function(){var s=function(t){if(t.reset)t.reset();};return function(){this.foreach(s);return this;};})(),pushDefault:(function(){var s=function(t){if(t.pushDefault)t.pushDefault();};return function(){this.foreach(s);return this;};})(),popDefault:(function(){var s=function(t){if(t.popDefault)t.popDefault();};return function(){this.foreach(s);return this;};})(),setupContent:function(){var s=arguments;this.foreach(function(t){if(t.setup)t.setup.apply(t,s);});},commitContent:function(){var s=arguments;this.foreach(function(t){if(t.commit)t.commit.apply(t,s);});},hide:function(){var u=this;var s=u._.element;if(!s.getParent())return;s.remove();p(u);if(!u._.parentDialog)k();else{var t=u._.parentDialog.getElement().getFirst();t.setStyle('z-index',parseInt(t.$.style.zIndex,10)+Math.floor(u._.editor.config.baseFloatZIndex/2));}CKEDITOR.dialog._.currentTop=u._.parentDialog;if(!u._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;CKEDITOR.document.removeListener('keydown',m);CKEDITOR.document.removeListener('keyup',n);u.restoreSelection();u._.editor.focus();}else CKEDITOR.dialog._.currentZIndex-=10;u.fire('hide',{});},addPage:function(s){var C=this;var t=[],u=s.title?'title="'+CKEDITOR.tools.htmlEncode(s.title)+'" ':'',v=s.elements,w=CKEDITOR.dialog._.uiElementBuilders.vbox.build(C,{type:'vbox',className:'cke_dialog_page_contents',children:s.elements,expand:!!s.expand},t),x=CKEDITOR.dom.element.createFromHtml(t.join('')),y=CKEDITOR.dom.element.createFromHtml(['<table><tbody><tr><td class="cke_dialog_tab" ',u,'>','<table border="0" cellspacing="0" cellpadding="0"><tbody><tr>','<td class="cke_dialog_tab_left"></td>','<td class="cke_dialog_tab_center">',CKEDITOR.tools.htmlEncode(s.label.replace(/ /g,' ')),'</td>','<td class="cke_dialog_tab_right"></td>','</tr></tbody></table></td></tr></tbody></table>'].join(''));y=y.getChild([0,0,0]);if(C._.lastTab)C._.lastTab.removeClass('last');y.addClass(C._.pageCount>0?'last':'first');if(C._.pageCount===0)C.parts.c.addClass('single_page');else C.parts.c.removeClass('single_page');C._.tabs[s.id]=[y,x];C._.pageCount++;C._.lastTab=y;var z=C._.contents[s.id]={},A,B=w.getChild();while(A=B.shift()){z[A.id]=A;if(typeof A.getChild=='function')B.push.apply(B,A.getChild());}y.unselectable();x.appendTo(C.parts.contents);y.insertBefore(C.parts.tabs.getChild(C.parts.tabs.getChildCount()-1));y.setAttribute('id',s.id+'_'+CKEDITOR.tools.getNextNumber());
x.setAttribute('name',s.id);if(s.accessKey){o(C,C,'CTRL+'+s.accessKey,r,q);C._.accessKeyMap['CTRL+'+s.accessKey]=s.id;}},selectPage:function(s){var y=this;for(var t in y._.tabs){var u=y._.tabs[t][0],v=y._.tabs[t][1];if(t!=s){u.removeClass('cke_dialog_tab_selected');v.hide();}}var w=y._.tabs[s];w[0].addClass('cke_dialog_tab_selected');w[1].show();var x=y;},hidePage:function(s){var t=this._.tabs[s]&&this._.tabs[s][0];if(!t)return;t.hide();},showPage:function(s){var t=this._.tabs[s]&&this._.tabs[s][0];if(!t)return;t.show();},getElement:function(){return this._.element;},getContentElement:function(s,t){return this._.contents[s][t];},getValueOf:function(s,t){return this.getContentElement(s,t).getValue();},setValueOf:function(s,t,u){return this.getContentElement(s,t).setValue(u);},getButton:function(s){return this._.buttons[s];},click:function(s){return this._.buttons[s].click();},disableButton:function(s){return this._.buttons[s].disable();},enableButton:function(s){return this._.buttons[s].enable();},getPageCount:function(){return this._.pageCount;},getParentEditor:function(){return this._.editor;},saveSelection:function(){if(this._.editor.mode){var s=new CKEDITOR.dom.selection(this._.editor.document);this._.selectedRanges=s.getRanges();}},clearSavedSelection:function(){delete this._.selectedRanges;},restoreSelection:function(){var s=this;if(s._.editor.mode&&s._.selectedRanges)new CKEDITOR.dom.selection(s._.editor.document).selectRanges(s._.selectedRanges);}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(s,t){this._.dialogDefinitions[s]=t;},exists:function(s){return!!this._.dialogDefinitions[s];},okButton:(function(){var s=function(t,u){u=u||{};return CKEDITOR.tools.extend({id:'ok',type:'button',label:t.lang.common.ok,style:'width: 60px',onClick:function(v){var w=v.data.dialog;if(w.fire('ok',{hide:true}).hide!==false)w.hide();}},u,true);};s.type='button';s.override=function(t){return CKEDITOR.tools.extend(function(u){return s(u,t);},{type:'button'},true);};return s;})(),cancelButton:(function(){var s=function(t,u){u=u||{};return CKEDITOR.tools.extend({id:'cancel',type:'button',label:t.lang.common.cancel,style:'width: 60px',onClick:function(v){var w=v.data.dialog;if(w.fire('cancel',{hide:true}).hide!==false)w.hide();}},u,true);};s.type='button';s.override=function(t){return CKEDITOR.tools.extend(function(u){return s(u,t);},{type:'button'},true);};return s;})(),addUIElement:function(s,t){this._.uiElementBuilders[s]=t;},setMargins:function(s,t,u,v){this._.margins=[s,t,u,v];
}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null,margins:[0,0,0,0]};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var a={resizable:CKEDITOR.DIALOG_RESIZE_NONE,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},b=function(s,t,u){for(var v=0,w;w=s[v];v++){if(w.id==t)return w;if(u&&w[u]){var x=b(w[u],t,u);if(x)return x;}}return null;},c=function(s,t,u,v,w){if(u){for(var x=0,y;y=s[x];x++){if(y.id==u){s.splice(x,0,t);return t;}if(v&&y[v]){var z=c(y[v],t,u,v,true);if(z)return z;}}if(w)return null;}s.push(t);return t;},d=function(s,t,u){for(var v=0,w;w=s[v];v++){if(w.id==t)return s.splice(v,1);if(u&&w[u]){var x=d(w[u],t,u);if(x)return x;}}return null;},e=function(s,t){this.dialog=s;var u=t.contents;for(var v=0,w;w=u[v];v++)u[v]=new f(s,w);CKEDITOR.tools.extend(this,t);};e.prototype={getContents:function(s){return b(this.contents,s);},getButton:function(s){return b(this.buttons,s);},addContents:function(s,t){return c(this.contents,s,t);},addButton:function(s,t){return c(this.buttons,s,t);},removeContents:function(s){d(this.contents,s);},removeButton:function(s){d(this.buttons,s);}};var f=function(s,t){this._={dialog:s};CKEDITOR.tools.extend(this,t);};f.prototype={get:function(s){return b(this.elements,s,'children');},add:function(s,t){return c(this.elements,s,t,'children');},remove:function(s){d(this.elements,s,'children');}};var g=function(s){var t=null,u=null,v=s.getElement().getFirst(),w=s._.editor.config.dialog_magnetDistance,x=function(z){var A=s.getSize(),B=CKEDITOR.document.getWindow().getViewPaneSize(),C=z.data.$.screenX,D=z.data.$.screenY,E=C-t.x,F=D-t.y,G,H;t={x:C,y:D};u.x+=E;u.y+=F;if(u.x+CKEDITOR.dialog._.margins[3]<w)G=-CKEDITOR.dialog._.margins[3];else if(u.x-CKEDITOR.dialog._.margins[1]>B.width-A.width-w)G=B.width-A.width+CKEDITOR.dialog._.margins[1];else G=u.x;if(u.y+CKEDITOR.dialog._.margins[0]<w)H=-CKEDITOR.dialog._.margins[0];else if(u.y-CKEDITOR.dialog._.margins[2]>B.height-A.height-w)H=B.height-A.height+CKEDITOR.dialog._.margins[2];else H=u.y;s.move(G,H);z.data.preventDefault();},y=function(z){CKEDITOR.document.removeListener('mousemove',x);CKEDITOR.document.removeListener('mouseup',y);if(CKEDITOR.env.ie6Compat){var A=new CKEDITOR.dom.document(frames('cke_dialog_background_iframe').document);A.removeListener('mousemove',x);A.removeListener('mouseup',y);}};s.parts.title.on('mousedown',function(z){t={x:z.data.$.screenX,y:z.data.$.screenY};
CKEDITOR.document.on('mousemove',x);CKEDITOR.document.on('mouseup',y);u=s.getPosition();if(CKEDITOR.env.ie6Compat){var A=new CKEDITOR.dom.document(frames('cke_dialog_background_iframe').document);A.on('mousemove',x);A.on('mouseup',y);}z.data.preventDefault();},s);},h=function(s){var t=s.definition,u=t.minWidth||0,v=t.minHeight||0,w=t.resizable,x=function(M,N){M.y+=N;},y=function(M,N){M.x2+=N;},z=function(M,N){M.y2+=N;},A=function(M,N){M.x+=N;},B=null,C=null,D=s._.editor.config.magnetDistance,E=['tl','t','tr','l','r','bl','b','br'],F=function(M){var N=M.listenerData.part,O=s.getSize();C=s.getPosition();CKEDITOR.tools.extend(C,{x2:C.x+O.width,y2:C.y+O.height});B={x:M.data.$.screenX,y:M.data.$.screenY};CKEDITOR.document.on('mousemove',G,s,{part:N});CKEDITOR.document.on('mouseup',H,s,{part:N});if(CKEDITOR.env.ie6Compat){var P=new CKEDITOR.dom.document(frames('cke_dialog_background_iframe').document);P.on('mousemove',G,s,{part:N});P.on('mouseup',H,s,{part:N});}M.data.preventDefault();},G=function(M){var N=M.data.$.screenX,O=M.data.$.screenY,P=N-B.x,Q=O-B.y,R=CKEDITOR.document.getWindow().getViewPaneSize(),S=M.listenerData.part;if(S.search('t')!=-1)x(C,Q);if(S.search('l')!=-1)A(C,P);if(S.search('b')!=-1)z(C,Q);if(S.search('r')!=-1)y(C,P);B={x:N,y:O};var T,U,V,W;if(C.x+CKEDITOR.dialog._.margins[3]<D)T=-CKEDITOR.dialog._.margins[3];else if(S.search('l')!=-1&&C.x2-C.x<u+D)T=C.x2-u;else T=C.x;if(C.y+CKEDITOR.dialog._.margins[0]<D)U=-CKEDITOR.dialog._.margins[0];else if(S.search('t')!=-1&&C.y2-C.y<v+D)U=C.y2-v;else U=C.y;if(C.x2-CKEDITOR.dialog._.margins[1]>R.width-D)V=R.width+CKEDITOR.dialog._.margins[1];else if(S.search('r')!=-1&&C.x2-C.x<u+D)V=C.x+u;else V=C.x2;if(C.y2-CKEDITOR.dialog._.margins[2]>R.height-D)W=R.height+CKEDITOR.dialog._.margins[2];else if(S.search('b')!=-1&&C.y2-C.y<v+D)W=C.y+v;else W=C.y2;s.move(T,U);s.resize(V-T,W-U);M.data.preventDefault();},H=function(M){CKEDITOR.document.removeListener('mouseup',H);CKEDITOR.document.removeListener('mousemove',G);if(CKEDITOR.env.ie6Compat){var N=new CKEDITOR.dom.document(frames('cke_dialog_background_iframe').document);N.removeListener('mouseup',H);N.removeListener('mousemove',G);}},I=/[lr]/,J=/[tb]/;for(var K=0;K<E.length;K++){var L=s.parts[E[K]+'_resize'];if(w==CKEDITOR.DIALOG_RESIZE_NONE||w==CKEDITOR.DIALOG_RESIZE_HEIGHT&&I.test(E[K])||w==CKEDITOR.DIALOG_RESIZE_WIDTH&&J.test(E[K])){L.hide();continue;}L.on('mousedown',F,s,{part:E[K]});}},i,j=function(s){var t=CKEDITOR.document.getWindow(),u=['<div style="position: ',CKEDITOR.env.ie6Compat?'absolute':'fixed','; z-index: ',s.config.baseFloatZIndex,'; top: 0px; left: 0px; ','background-color: ',s.config.dialog_backgroundCoverColor,'" id="cke_dialog_background_cover">'];
if(CKEDITOR.env.ie6Compat)u.push('<iframe hidefocus="true" frameborder="0" name="cke_dialog_background_iframe" src="javascript: \'\'" ','style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; ','progid:DXImageTransform.Microsoft.Alpha(opacity=0)" ></iframe>');u.push('</div>');var v=CKEDITOR.dom.element.createFromHtml(u.join('')),w=function(){var z=t.getViewPaneSize();v.setStyles({width:z.width+'px',height:z.height+'px'});},x=function(){var z=t.getScrollPosition(),A=CKEDITOR.dialog._.currentTop;v.setStyles({left:z.x+'px',top:z.y+'px'});do{var B=A.getPosition();A.move(B.x,B.y);}while(A=A._.parentDialog)};i=w;t.on('resize',w);w();if(CKEDITOR.env.ie6Compat){var y=function(){x();arguments.callee.prevScrollHandler.apply(this,arguments);};t.$.setTimeout(function(){y.prevScrollHandler=window.onscroll||(function(){});window.onscroll=y;},0);x();}v.setOpacity(s.config.dialog_backgroundCoverOpacity);v.appendTo(CKEDITOR.document.getBody());},k=function(){var s=CKEDITOR.document.getById('cke_dialog_background_cover'),t=CKEDITOR.document.getWindow();if(s){s.remove();t.removeListener('resize',i);if(CKEDITOR.env.ie6Compat)t.$.setTimeout(function(){var u=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=u||null;},0);i=null;}},l={},m=function(s){var t=s.data.$.ctrlKey||s.data.$.metaKey,u=s.data.$.altKey,v=s.data.$.shiftKey,w=String.fromCharCode(s.data.$.keyCode),x=l[(t?'CTRL+':'')+(u?'ALT+':'')+(v?'SHIFT+':'')+w];if(!x||!x.length)return;x=x[x.length-1];x.keydown&&x.keydown.call(x.uiElement,x.dialog,x.key);s.data.preventDefault();},n=function(s){var t=s.data.$.ctrlKey||s.data.$.metaKey,u=s.data.$.altKey,v=s.data.$.shiftKey,w=String.fromCharCode(s.data.$.keyCode),x=l[(t?'CTRL+':'')+(u?'ALT+':'')+(v?'SHIFT+':'')+w];if(!x||!x.length)return;x=x[x.length-1];x.keyup&&x.keyup.call(x.uiElement,x.dialog,x.key);s.data.preventDefault();},o=function(s,t,u,v,w){var x=l[u]||(l[u]=[]);x.push({uiElement:s,dialog:t,key:u,keyup:w||s.accessKeyUp,keydown:v||s.accessKeyDown});},p=function(s){for(var t in l){var u=l[t];for(var v=u.length-1;v>=0;v--)if(u[v].dialog==s||u[v].uiElement==s)u.splice(v,1);if(u.length===0)delete l[t];}},q=function(s,t){if(s._.accessKeyMap[t])s.selectPage(s._.accessKeyMap[t]);},r=function(s,t){};(function(){var s=/^\d+(?:\.\d+)?$/,t=function(u){return u+(s.test(u)?'px':'');};CKEDITOR.ui.dialog={uiElement:function(u,v,w,x,y,z,A){if(arguments.length<4)return;var B=(x.call?x(v):x)||('div'),C=['<',B,' '],D=(y&&y.call?y(v):y)||({}),E=(z&&z.call?z(v):z)||({}),F=(A&&A.call?A(u,v):A)||(''),G=this.domId=E.id||CKEDITOR.tools.getNextNumber()+'_uiElement',H=this.id=v.id,I;
E.id=G;var J={};if(v.type)J['cke_dialog_ui_'+v.type]=1;if(v.className)J[v.className]=1;var K=E['class']&&E['class'].split?E['class'].split(' '):[];for(I=0;I<K.length;I++)if(K[I])J[K[I]]=1;var L=[];for(I in J)L.push(I);E['class']=L.join(' ');if(v.title)E.title=v.title;var M=(v.style||'').split(';');for(I in D)M.push(I+':'+D[I]);for(I=M.length-1;I>=0;I--)if(M[I]==='')M.splice(I,1);if(M.length>0)E.style=(E.style||'')+(M.join('; '));for(I in E)C.push(I+'="'+CKEDITOR.tools.htmlEncode(E[I])+'" ');C.push('>',F,'</',B,'>');w.push(C.join(''));(this._||(this._={})).dialog=u;if(typeof v.isChanged=='boolean')this.isChanged=function(){return v.isChanged;};if(typeof v.isChanged=='function')this.isChanged=v.isChanged;CKEDITOR.event.implementOn(this);this.registerEvents(v);if(this.accessKeyUp&&this.accessKeyDown&&v.accessKey)o(this,u,'CTRL+'+v.accessKey);CKEDITOR.tools.extend(this,v);},hbox:function(u,v,w,x,y){if(arguments.length<4)return;this._||(this._={});var z=this._.children=v,A=y&&y.widths||null,B=y&&y.height||null,C={},D,E=function(){var F=['<tbody><tr class="cke_dialog_ui_hbox">'];for(D=0;D<w.length;D++){var G='cke_dialog_ui_hbox_child',H=[];if(D===0)G='cke_dialog_ui_hbox_first';if(D==w.length-1)G='cke_dialog_ui_hbox_last';F.push('<td class="',G,'" ');if(A)if(A[D])H.push('width:'+t(A[D]));else H.push('width:'+Math.floor(100/w.length)+'%');if(B)H.push('height:'+t(B));if(y&&y.padding!=undefined)H.push('padding:'+t(y.padding));if(H.length>0)F.push('style="'+H.join('; ')+'" ');F.push('>',w[D],'</td>');}F.push('</tr></tbody>');return F.join('');};CKEDITOR.ui.dialog.uiElement.call(this,u,y||{type:'hbox'},x,'table',C,{align:y&&y.align||(u.getParentEditor().lang.dir=='ltr'?'left':'right')},E);},vbox:function(u,v,w,x,y){if(arguments.length<3)return;this._||(this._={});var z=this._.children=v,A=y&&y.width||null,B=y&&y.heights||null,C=function(){var D=['<table cellspacing="0" border="0" '];D.push('style="');if(y&&y.expand)D.push('height:100%;');D.push('width:'+t(A||'100%'),';');D.push('"');D.push('align="',CKEDITOR.tools.htmlEncode(y&&y.align||(u.getParentEditor().lang.dir=='ltr'?'left':'right')),'" ');D.push('><tbody>');for(var E=0;E<w.length;E++){var F=[];D.push('<tr><td ');if(A)F.push('width:'+t(A||'100%'));if(B)F.push('height:'+t(B[E]));else if(y&&y.expand)F.push('height:'+Math.floor(100/w.length)+'%');if(y&&y.padding!=undefined)F.push('padding:'+t(y.padding));if(F.length>0)D.push('style="',F.join('; '),'" ');D.push(' class="cke_dialog_ui_vbox_child">',w[E],'</td></tr>');
}D.push('</tbody></table>');return D.join('');};CKEDITOR.ui.dialog.uiElement.call(this,u,y||{type:'vbox'},x,'div',null,null,C);}};})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId);},getInputElement:function(){return this.getElement();},getDialog:function(){return this._.dialog;},setValue:function(s){this.getInputElement().setValue(s);this.fire('change',{value:s});return this;},getValue:function(){return this.getInputElement().getValue();},isChanged:function(){return false;},selectParentTab:function(){var s=this.getInputElement(),t=s,u;while((t=t.getParent())&&(t.$.className.search('cke_dialog_page_contents')==-1)){}u=t.getAttribute('name');this._.dialog.selectPage(u);return this;},focus:function(){this.selectParentTab().getInputElement().focus();return this;},registerEvents:function(s){var t=/^on([A-Z]\w+)/,u,v=function(x,y,z,A){y.on('load',function(){x.getInputElement().on(z,A,x);});};for(var w in s){if(!(u=w.match(t)))continue;if(this.eventProcessors[w])this.eventProcessors[w].call(this,this._.dialog,s[w]);else v(this,this._.dialog,u[1].toLowerCase(),s[w]);}return this;},eventProcessors:{onLoad:function(s,t){s.on('load',t);},onShow:function(s,t){s.on('show',t);},onHide:function(s,t){s.on('hide',t);}},accessKeyDown:function(s,t){this.focus();},accessKeyUp:function(s,t){},disable:function(){var s=this.getInputElement();s.setAttribute('disabled','true');s.addClass('cke_disabled');},enable:function(){var s=this.getInputElement();s.removeAttribute('disabled');s.removeClass('cke_disabled');}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement(),{getChild:function(s){var t=this;if(arguments.length<1)return t._.children.concat();if(!s.splice)s=[s];if(s.length<2)return t._.children[s[0]];else return t._.children[s[0]]&&t._.children[s[0]].getChild?t._.children[s[0]].getChild(s.slice(1,s.length)):null;}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox();(function(){var s={build:function(t,u,v){var w=u.children,x,y=[],z=[];for(var A=0;A<w.length&&(x=w[A]);A++){var B=[];y.push(B);z.push(CKEDITOR.dialog._.uiElementBuilders[x.type].build(t,x,B));}return new CKEDITOR.ui.dialog[u.type](t,z,y,v,u);}};CKEDITOR.dialog.addUIElement('hbox',s);CKEDITOR.dialog.addUIElement('vbox',s);})();CKEDITOR.dialogCommand=function(s){this.dialogName=s;};CKEDITOR.dialogCommand.prototype={exec:function(s){s.openDialog(this.dialogName);}};(function(){var s=/^([a]|[^a])+$/,t=/^\d*$/,u=/^\d*(?:\.\d+)?$/;
CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){return function(){var B=this;var v=B&&B.getValue?B.getValue():arguments[0],w=undefined,x=CKEDITOR.VALIDATE_AND,y=[],z;for(z=0;z<arguments.length;z++)if(typeof arguments[z]=='function')y.push(arguments[z]);else break;if(z<arguments.length&&typeof arguments[z]=='string'){w=arguments[z];z++;}if(z<arguments.length&&typeof arguments[z]=='number')x=arguments[z];var A=x==CKEDITOR.VALIDATE_AND?true:false;for(z=0;z<y.length;z++)if(x==CKEDITOR.VALIDATE_AND)A=A&&y[z](v);else A=A||y[z](v);if(!A){if(w!==undefined)alert(w);if(B&&(B.select||B.focus))B.select||B.focus();return false;}return true;};},regex:function(v,w){return function(){var y=this;var x=y&&y.getValue?y.getValue():arguments[0];if(!v.test(x)){if(w!==undefined)alert(w);if(y&&(y.select||y.focus))if(y.select)y.select();else y.focus();return false;}return true;};},notEmpty:function(v){return this.regex(s,v);},integer:function(v){return this.regex(t,v);},number:function(v){return this.regex(u,v);},equals:function(v,w){return this.functions(function(x){return x==v;},w);},notEqual:function(v,w){return this.functions(function(x){return x!=v;},w);}};})();})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(a){var b=CKEDITOR.dialog._.dialogDefinitions[a];if(typeof b=='function'){var c=this._.storedDialogs||(this._.storedDialogs={}),d=c[a]||(c[a]=new CKEDITOR.dialog(this,a));d.show();return d;}var e=CKEDITOR.document.getBody(),f=e.$.style.cursor,g=this;e.setStyle('cursor','wait');CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(b),function(){g.openDialog(a);e.setStyle('cursor',f);});return null;}});CKEDITOR.config.dialog_backgroundCoverColor='white';CKEDITOR.config.dialog_backgroundCoverOpacity=0.5;CKEDITOR.config.dialog_magnetDistance=20;
